\documentclass[a4paper, 12pt]{article}
\usepackage[utf8]{inputenc} % UTF-8 Kodierung verwenden
\usepackage[backend=biber, sorting=none]{biblatex}
\usepackage[total={6.5in, 9in}]{geometry}
% \usepackage[onehalfspacing]{setspace} % 1.5 Spacing 
\usepackage[singlespacing]{setspace} % 1 Spacing 
\usepackage[T1]{fontenc}    % Fonts mit westeuropäischer Codierung verwenden
\usepackage[ngerman]{babel} % Neue deutsche Sprache
\usepackage{fancyhdr}       % Kopf- und Fusszeilen
\usepackage{tikz}           % Fuer das Erstellen von einfachen Grafiken
\usepackage{tkz-berge}
\usepackage{float}          % Fuer den Positionierungsbefehl '[H]'
\usepackage{fancyhdr}       % Angepasste Header und Footer
\usepackage{titling}        % Fuer Befehle wie \thetitle
% \usepackage{showframe}     % Boxen mit Rand visualisieren (nur für das Schreiben des Dokuments brauchbar!)
\usepackage{csquotes}
\usepackage{translator}
\usepackage{subcaption}
\usepackage{caption}
\usepackage[
nonumberlist, %keine Seitenzahlen anzeigen
%acronym,      %ein Abkürzungsverzeichnis erstellen
toc,          %Einträge im Inhaltsverzeichnis
section,      %im Inhaltsverzeichnis auf section-Ebene erscheinen
nopostdot     %Den Punkt am Ende jeder Beschreibung deaktivieren
]{glossaries}
\makenoidxglossaries
 
% \setlength{\abovecaptionskip}{1ex}
% \setlength{\belowcaptionskip}{1ex}
\setlength{\floatsep}{24pt}
\setlength{\textfloatsep}{24pt}
\setlength{\headheight}{15pt}

\setcounter{tocdepth}{1}

\title{De-Novo-Sequencing using Spectrum-Graphs, enabling Open Searches}
\author{Dominik Habermann}
\date{\today}

% Kopf- und Fussnoten anpassen
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\thetitle}
%\fancyhead[R]{\thetitle} 
\fancyfoot[C]{\thepage}



\addbibresource{./Resources/P2_De-Novo-Sequencing using Spectrum-Graphs.bib}
\input{./Resources/P2_De-Novo-Sequencing using Spectrum-Graphs.gls}
\input{./Resources/P2_De-Novo-Sequencing using Spectrum-Graphs.acr}

\newcommand{\gerquot}[1]{\glqq#1\grqq}
\newcommand{\dashAndSpace}{\textendash \space}
\newcommand{\tikzScale}{1.15}
\newcommand{\xAxisUnit}{$m/z$}
\newcommand{\yAxisUnit}{$y$}

\renewcommand{\floatpagefraction}{0.8}
% Workaround um die Überschrift des Glossars anzupassen
% Siehe: https://tex.stackexchange.com/questions/426390/how-can-i-rename-the-header-titles-of-the-glossary
\addto\captionsngerman{%
\renewcommand*{\glossaryname}{Begriffserklärungen}%
}


 
%%%%% %%%%% %%%%% %%%%% %%%%% \begin{document} %%%%% %%%%% %%%%% %%%%% %%%%%
\begin{document}

\maketitle

\section{Einleitung}
Im ersten Kapitel findet zu Beginn eine Erklärung der wichtigsten Begriffe und Abkürzungen statt. Dazu wird eine Themenabgrenzung durchgeführt sowie die Ausgangssituation beschrieben.

\printnoidxglossaries

\subsection{Themenabgrenzung}
Folgende Aspekte sind Bestandteil dieser Ausarbeitung:
\begin{itemize}
   \item Was ist die \gls{gls:DeNovo}?
   \item Was erhofft man sich von dieser Technologie?
   % \item U.U ist ein neuer Punkt notwendig, welcher die physikalischen Ansätze beschreibt, die 
   \item Welche Probleme liegen vor, die von der Seite der Informatik gelöst / verbessert werden können?
   \item Inwiefern spielen die Spektrums-Graphen dabei eine Rolle?
\end{itemize}

\subsection{Ausgangssituation}
Mit Hilfe der \gls{gls:DeNovo} ist grundsätzlich die Bestimmung von unbekannten Aminosäuresequenzen möglich. Das Verfahren arbeitet allerdings nicht in jeder Situation zuverlässig genug. Dadurch wird das Ermitteln von unbekannten Sequenzen erschwert. Auch bei bereits bekannten Sequenzen führt die nicht ausreichende Zuverlässigkeit dazu, dass bei Ergebnissen nicht sicher unterschieden werden kann, ob eine Änderung in der Aminosäuresequenz vorliegt oder ob fehlerhafte Daten bestimmt wurden.
Das Ziel ist mit Unterstützung von Software eine Möglichkeit bereitzustellen, um die Zuverlässigkeit der \gls{gls:DeNovo} zu erhöhen. Gleichzeitig soll die Implementierung ein effizienteres Werkzeug darstellen als die bereits verfügbaren Ansätze.


\section{De-Novo-Peptidsequenzierung und Spektrums-Graphen im Detail}
In diesem Abschnitt werden die relevanten Herangehensweisen sowohl für die Datengewinnung als auch für deren Auswertung erklärt.

\subsection{Datengewinnung}
Die \gls{gls:DeNovo} nutzt die sogenannte \gls{gls:TMassSpek} für die Bestimmung der Peptidsequenz. Dabei wird die physikalische Eigenschaft ausgenutzt, dass jedes Atom bzw. jedes Molekül \dashAndSpace wenn es einer \gls{gls:Ionisation} unterzogen wurde \dashAndSpace ein charakteristisches \gls{gls:MassSpek} besitzt. Das \gls{gls:MassSpek} stellt also eine Art \gerquot{Fingerabdruck} eines Moleküls dar und macht dieses ermittelbar.

% Beispielgrafik eines Massenspektrums hinzufuegen

\subsubsection{\glsentrytext{gls:TMassSpek} bei größeren Molekülen}
Bei größeren Molekülen (wie einem Protein) führt die \gls{gls:Ionisation} dazu, dass das Molekül in kleinere spezifische Ionen zerfällt (sog. Fragmentierung). Die Fragmentierungsinformationen einer \gls{gls:DeNovo} sind meist unvollständig, da fehlende Daten bei einem Fragmentierungsschritt die Güte des Endergebnisses negativ beeinflusst. Dies wird insbesondere dann ein Problem, wenn unbekannte Änderungen in einer Peptidsequenz vorhanden sind.

Um dieses Problem zu verringern können unterschiedliche Techniken parallel eingesetzt werden, welche verschiedene Fragmente erzeugen und daher auch verschiedenartige \glspl{gls:MassSpek} zur Folge haben.\footnote{Konkret: Es wird sowohl das \gls{acr:HCD} als auch das \gls{acr:ETD} Verfahren angewendet.}

\subsection{Datenaufbereitung}
Typischerweise betrachet man die sog. \gerquot{\glspl{gls:Peak}} in den \glspl{gls:MassSpek}. Jeder \gls{gls:Peak} stellt ein unterschiedliches Ion dar. Dazu kommen Messungenauigkeiten sowie Hintergrundrauschen. Durch die hohe Anzahl an möglichen Ionen kann nicht ohne weiteres differenziert werden, welcher der \glspl{gls:Peak} von Ionen erzeugt wurden und welche nicht.

% Frage an Dominik: Ist hier eine einfache Auflistung an Techniken für die Datenaufbereitung besser?
Der Algorithmus für die Datenaufbereitung berechnet den natürlichen Logarithmus von den Intensitäten der \glspl{gls:Peak}, um Hintergrundrauschen und Messungenauigkeiten nicht überzupriorisieren. Zusätzlich dazu werden \glspl{gls:Peak}, die in einem Toleranzbereich nebeneinander liegen, zusammengefasst. Am Ende werden die \glspl{gls:Peak} entfernt, bei denen bekannt ist, dass es sich nicht um relevante Ionen handeln kann. (z.B. \glspl{gls:Peak} von Isotopen)

\begin{figure}[htb]
   \centering
   \begin{minipage}[t]{.4\linewidth}
      \centering
      \begin{tikzpicture}[scale=\tikzScale, baseline=(current bounding box.center)]
         \draw [<->,thick] (0,2.75) node (yaxis) [above] {\yAxisUnit} 
         |- (3,0) node (xaxis) [right] {\xAxisUnit};
         
         \draw[thick] (0.2,0) -- (0.2,1.1);
         \draw[thick] (0.3,0) -- (0.3,1.6);
         \draw[thick] (0.6,0) -- (0.6,1.7);
         \draw[thick] (0.8,0) -- (0.8,1.2);
         \draw[thick] (1.0,0) -- (1.0,1.1);
         
         \draw[color=red,thick] (1.2,0) -- (1.2,2.65);
         \draw[thick] (1.4,0) -- (1.4,1.4);
         \draw[thick] (1.6,0) -- (1.6,1.2);
         \draw[thick] (1.8,0) -- (1.8,1.3);
         \draw[thick] (2.0,0) -- (2.0,1.8);
         
         \draw[thick] (1.1,0) -- (1.1,2.0);
         \draw[color=red,thick] (0.35,0) -- (0.35,2.25);
         \draw[thick] (1.9,0) -- (1.9,1.4);
         \draw[color=red,thick] (2.2,0) -- (2.2,2.6);
         \draw[thick] (2.5,0) -- (2.5,1.25);
         
         \draw[thick] (2.7,0) -- (2.7,1.1);
         \foreach \x in {1,...,6}
         {
            \draw[thick] (1.2+\x*0.05,0) -- (1.2+\x*0.05,1.0+\x*0.15);
         }
      \end{tikzpicture}%
      % \subcaption{Exemplarische Rohdaten}
   \end{minipage}%
   \textbf{$\rightarrow$}
   \begin{minipage}[t]{.4\linewidth}
      \centering
      \begin{tikzpicture}[scale=\tikzScale, baseline=(current bounding box.center)]
         \draw [<->,thick] (0,2.75) node (yaxis) [above] {\yAxisUnit} 
         |- (3,0) node (xaxis) [right] {\xAxisUnit};
         
         \draw[thick] (0.2,0) -- (0.2,{ln(1.1)});
         \draw[thick] (0.3,0) -- (0.3,{ln(1.6)});
         \draw[thick] (0.6,0) -- (0.6,{ln(1.7)});
         \draw[thick] (0.8,0) -- (0.8,{ln(1.2)});
         \draw[thick] (1.0,0) -- (1.0,{ln(1.1)});
         
         \draw[color=red,thick] (1.2,0) -- (1.2,{ln(2.65)});
         \draw[thick] (1.4,0) -- (1.4,{ln(1.4)});
         \draw[thick] (1.6,0) -- (1.6,{ln(1.2)});
         \draw[thick] (1.8,0) -- (1.8,{ln(1.3)});
         \draw[thick] (2.0,0) -- (2.0,{ln(1.8)});
         
         \draw[thick] (1.1,0) -- (1.1,{ln(2.0)});
         \draw[color=red,thick] (0.35,0) -- (0.35,{ln(2.25)});
         \draw[thick] (1.9,0) -- (1.9,{ln(1.4)});
         \draw[color=red,thick] (2.2,0) -- (2.2,{ln(2.6)});
         \draw[thick] (2.5,0) -- (2.5,{ln(1.25)});
         
         \draw[thick] (2.7,0) -- (2.7,{ln(1.1)});
         \foreach \x in {1,...,6}
         {
            \draw[thick] (1.2+\x*0.05,0) -- (1.2+\x*0.05,{ln(1.0+\x*0.15)});
         }
      \end{tikzpicture}
      %\subcaption{Exemplarische Rohdaten}
   \end{minipage}
   \caption*{Schematische Darstellung: Anwendung des $ln$ auf Rohdaten}
\end{figure}

\begin{figure}[htb]
   \centering
   \begin{minipage}[t]{.4\linewidth}
      \centering
      \begin{tikzpicture}[scale=\tikzScale, baseline=(current bounding box.center)]
         \draw [<->,thick] (0,2.75) node (yaxis) [above] {\yAxisUnit} 
         |- (3,0) node (xaxis) [right] {\xAxisUnit};
         
         \draw[thick] (0.2,0) -- (0.2,{ln(1.1)});
         \draw[thick] (0.3,0) -- (0.3,{ln(1.6)});
         \draw[thick] (0.6,0) -- (0.6,{ln(1.7)});
         \draw[thick] (0.8,0) -- (0.8,{ln(1.2)});
         \draw[thick] (1.0,0) -- (1.0,{ln(1.1)});
         
         \draw[thick] (1.2,0) -- (1.2,{ln(2.65)});
         \draw[thick] (1.4,0) -- (1.4,{ln(1.4)});
         \draw[thick] (1.6,0) -- (1.6,{ln(1.2)});
         \draw[thick] (1.8,0) -- (1.8,{ln(1.3)});
         \draw[thick] (2.0,0) -- (2.0,{ln(1.8)});
         
         \draw[thick] (1.1,0) -- (1.1,{ln(2.0)});
         \draw[thick] (0.35,0) -- (0.35,{ln(2.25)});
         \draw[thick] (1.9,0) -- (1.9,{ln(1.4)});
         \draw[thick] (2.2,0) -- (2.2,{ln(2.6)});
         \draw[thick] (2.5,0) -- (2.5,{ln(1.25)});
         
         \draw[thick] (2.7,0) -- (2.7,{ln(1.1)});
         \foreach \x in {1,...,6}
         {
            \draw[color=red,thick] (1.2+\x*0.05,0) -- (1.2+\x*0.05,{ln(1.0+\x*0.15)});
         }
         
         \draw[dotted] (0.4,0) -- (0.4,2.75);
         \draw[dotted] (2.6,0) -- (2.6,2.75);
         \fill[red!25!,opacity=.25] (0,0) rectangle (0.4,2.75);
         \fill[red!25!,opacity=.25] (2.6,0) rectangle (3.0,2.75);
         \fill[green!25!,opacity=.25] (0.4,0) rectangle (2.6,2.75);
      \end{tikzpicture}%
      %\subcaption{Exemplarische Rohdaten}
   \end{minipage}%
   \textbf{$\rightarrow$}
   \begin{minipage}[t]{.4\linewidth}
      \centering
      \begin{tikzpicture}[scale=\tikzScale, baseline=(current bounding box.center)]
         \draw [<->,thick] (0,2.75) node (yaxis) [above] {\yAxisUnit} 
         |- (3,0) node (xaxis) [right] {\xAxisUnit};
         
         \draw[thick] (0.6,0) -- (0.6,{ln(1.7)});
         \draw[thick] (0.8,0) -- (0.8,{ln(1.2)});
         \draw[thick] (1.0,0) -- (1.0,{ln(1.1)});
         
         \draw[thick] (1.2,0) -- (1.2,{ln(2.65)});
         %\draw[thick] (1.4,0) -- (1.4,{ln(1.4)});
         \draw[thick] (1.6,0) -- (1.6,{ln(1.2)});
         \draw[thick] (1.8,0) -- (1.8,{ln(1.3)});
         \draw[thick] (2.0,0) -- (2.0,{ln(1.8)});
         
         \draw[thick] (1.1,0) -- (1.1,{ln(2.0)});
         \draw[thick] (1.9,0) -- (1.9,{ln(1.4)});
         \draw[thick] (2.2,0) -- (2.2,{ln(2.6)});
         \draw[thick] (2.5,0) -- (2.5,{ln(1.25)});
         
         \draw[color=red,ultra thick] (1.2+1*0.05,0) -- (1.2+1*0.05,{ln(1.0+1*0.15)});
         \draw[color=red,ultra thick] (1.2+3*0.05,0) -- (1.2+3*0.05,{ln(1.0+3*0.15)});
         \draw[color=red,ultra thick] (1.2+5*0.05,0) -- (1.2+5*0.05,{ln(1.0+5*0.15)});
         
         \draw[dotted] (0.4,0) -- (0.4,2.75);
         \draw[dotted] (2.6,0) -- (2.6,2.75);
         \fill[red!25!,opacity=.25] (0,0) rectangle (0.4,2.75);
         \fill[red!25!,opacity=.25] (2.6,0) rectangle (3.0,2.75);
         \fill[green!25!,opacity=.25] (0.4,0) rectangle (2.6,2.75);
      \end{tikzpicture}
      %\subcaption{Exemplarische Rohdaten}
   \end{minipage}
   \caption*{Schematische Darstellung: Entfernen von irrelevanten \glspl{gls:Peak} sowie zusammenfassen naheliegender \glspl{gls:Peak}}
\end{figure}

% `\glsentrytext` funktioniert nicht für `\glspl`
\subsection{Konvertierung von \glspl{gls:MassSpek}}
Das Ziel der Konvertierung ist das Erzeugen eines \gls{gls:SpecGraph}en. Um von einem \gls{gls:MassSpek} zu einem \gls{gls:SpecGraph}en zu kommen, werden die \glspl{gls:Peak}, die nach der Datenaufbereitung (Siehe ...) übrig bleiben, als Knoten gewertet. Dazu kommt ein Start- und Endknoten. Jeder Knoten bekommt eine Gewichtung; diese Gewichtung entspricht der Stärke des \gls{gls:Peak}s.
Gerichtete Kanten zwischen den Knoten werden ausgebildet, wenn diese eine Differenz von genau einer oder zwei Aminosäurereste\footnote{Da eine Aminosäure vielerlei an Reste besitzen kann, ergibt sich aus dieser Differenz ein effektives Intervall von 1 bis etwa 300u.} besitzen.

\newcommand{\colorA}{white!30!green}
\newcommand{\colorB}{black!10!yellow}
\newcommand{\colorC}{white!40!red}
\newcommand{\colorD}{white!25!orange}
\newcommand{\colorE}{white!45!blue}
\newcommand{\colorF}{white!5!magenta}

\begin{figure}[htb]
   \centering
      \begin{tikzpicture}[scale=\tikzScale*1.75, baseline=(current bounding box.center)]
         \draw [<->,thick] (0,2.75) node (yaxis) [above] {\yAxisUnit} 
         |- (3,0) node (xaxis) [below] {\xAxisUnit};
         
         \draw[thick] (0.6,0) -- (0.6,{ln(1.7)}) node [right, rotate=90, color=\colorA] {\textbf{A}};
         \draw[thick] (0.8,0) -- (0.8,{ln(1.2)});
         \draw[thick] (1.0,0) -- (1.0,{ln(1.1)});
         
         \draw[thick] (1.2,0) -- (1.2,{ln(2.65)}) node [right, rotate=90,
         color=\colorC] {\textbf{C}};
         \draw[thick] (1.4,0) -- (1.4,{ln(1.4)});
         \draw[thick] (1.6,0) -- (1.6,{ln(1.2)});
         \draw[thick] (1.8,0) -- (1.8,{ln(1.3)});
         \draw[thick] (2.0,0) -- (2.0,{ln(1.8)}) node [right, rotate=90, color=\colorE] {\textbf{E}};
         
         \draw[thick] (1.1,0) -- (1.1,{ln(2.0)}) node [right, rotate=90, color=\colorB] {\textbf{B}};
         \draw[thick] (1.9,0) -- (1.9,{ln(1.4)});
         \draw[thick] (2.2,0) -- (2.2,{ln(2.6)}) node [right, rotate=90, color=\colorF] {\textbf{F}};
         \draw[thick] (2.5,0) -- (2.5,{ln(1.25)});
         
         \draw[thick] (1.2+1*0.05,0) -- (1.2+1*0.05,{ln(1.0+1*0.15)});
         \draw[thick] (1.2+3*0.05,0) -- (1.2+3*0.05,{ln(1.0+3*0.15)});
         \draw[thick] (1.2+5*0.05,0) -- (1.2+5*0.05,{ln(1.0+5*0.15)}) node [right, rotate=90, color=\colorD] {\textbf{D}};
      \end{tikzpicture}
      \caption*{Schematische Darstellung: Ausgewählte \glspl{gls:Peak}}
\end{figure}

% https://tex.stackexchange.com/questions/245448/adjusting-edge-and-vertex-label

\begin{figure}[htb]
   \centering
   \begin{tikzpicture}[scale=0.75,transform shape]
      \tikzstyle{VertexStyle}=[shape=circle,fill=white,draw=black,line width=1pt]
      \Vertex[x=0,y=0]{Start}
      \Vertex[x=10,y=0]{End}
      
      \tikzstyle{VertexStyle}=[shape=circle,fill=\colorA,draw=black,line width=0.75pt]
      \Vertex[x=3,y=2]{A}
      \tikzstyle{VertexStyle}=[shape=circle,fill=\colorB,draw=black,line width=0.75pt]
      \Vertex[x=3,y=-2]{B}
      \tikzstyle{VertexStyle}=[shape=circle,fill=\colorC,draw=black,line width=0.75pt]
      \Vertex[x=5,y=2]{C}
      \tikzstyle{VertexStyle}=[shape=circle,fill=\colorD,draw=black,line width=0.75pt]
      \Vertex[x=5,y=-2]{D}
      \tikzstyle{VertexStyle}=[shape=circle,fill=\colorE,draw=black,line width=0.75pt]
      \Vertex[x=7,y=2]{E}
      \tikzstyle{VertexStyle}=[shape=circle,fill=\colorF,draw=black,line width=0.75pt]
      \Vertex[x=7,y=-2]{F}
   
%       \Vertex[x=0,y=0]{K}
%       \Vertex[x=0,y=2]{F}
%       \Vertex[x=-1,y=4]{D}
%       \Vertex[x=3,y=7]{H}
%       \Vertex[x=8,y=5]{B}
%       \Vertex[x=9,y=2]{N}
%       \Vertex[x=5,y=0]{M}
%       \tikzstyle{VertexStyle}=[shape=circle,fill=\colorD,draw=black,line width=0.75pt]
%       \Vertex[x=3,y=1]{S}
%       %\tikzstyle{LabelStyle}=[fill=white,sloped,bottom]
%       \tikzstyle{EdgeStyle}=[above,sloped,midway]
%       \Edge[label=$120$](K)(F)
%       \Edge[label=$650$](H)(S)
%       \Edge[label=$780$](H)(M)
%       \Edge[label=$490$](D)(B)
%       \Edge[label=$600$](D)(M)
%       \Edge[label=$580$](B)(M)
%       \Edge[label=$600$](H)(N)
%       \Edge[label=$490$](F)(H)
%       \tikzstyle{EdgeStyle}=[bend right]
%       \Edge[label=$630$](S)(B)
%       \Edge[label=$210$](S)(N)
%       \Edge[label=$230$](S)(M)
   \end{tikzpicture}
   \caption*{Schematische Darstellung: Erzeugter DAG}
\end{figure}

\subsection{Datenauswertung}


\section{Ergebnisse/Evaluierung}
\subsection{Probleme in der Praxis}
\subsection{Lösungsansätze}


\section{Zusammenfassung}
\subsection{Ungelöste Probleme}
% Isomere können nicht differenziert werden
\subsection{Kritische Betrachtung}


\section{Section}
% \cite{OpenPNovo}
% \cite{pNovoPlus}

\begingroup
\setlength{\emergencystretch}{.5em}
\printbibliography
\endgroup

\appendix
\section{Appendix Section}
Appendix



\end{document}
%%%%% %%%%% %%%%% %%%%% %%%%% \end{document} %%%%% %%%%% %%%%% %%%%% %%%%%
